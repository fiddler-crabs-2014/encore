<!DOCTYPE html>
<html>
<head>
  <title>Encore</title>
  <link href="//fonts.googleapis.com/css?family=Source+Sans Pro:200italic,200,300italic,300,400italic,400,600italic,600,700italic,700,900italic,900" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Lato:100italic,100,300italic,300,400italic,400,700italic,700,900italic,900" rel="stylesheet" type="text/css">

  <%= stylesheet_link_tag    'application', media: 'all' %>
  <%= javascript_include_tag 'application' %>
  <%= csrf_meta_tags %>

  <!-- Code for Google Freebase Search -->
  <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/freebase/suggest/4_2/suggest.min.css" />
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/freebase/suggest/4_2/suggest.min.js"></script>

  <script type="text/javascript">
  $(function() {
    $("#myinput").suggest({ "key" : "AIzaSyCJlvFbCyGpDSqxWQiliVKGqliCVocb5F0",
                            filter:'(all type:/music/artist)'
                          });
  });
  </script>

</head>
<body>
    <nav>
      <ul>
        <h1><a href="/" class="headline">Encore</a></h1>
        <% if current_user %>
          <li>
            <%= link_to user_path(session[:user_id]) do %>
              <strong><%= current_user.name %></strong>
            <% end %>
          </li>

          <li>
            <%= link_to signout_path, id: "sign_out" do %>
              <strong>Sign Out</strong>
            <% end %>
          </li>
          <% else %>
            <li><%= link_to "Sign in with Facebook", "/auth/facebook", id: "sign_in" %></li>
        <% end %>
        </li>
      </ul>
    </nav>

  <% if current_user %>
    <p><%= link_to "Invite Facebook Friends", "#", id: "invite_fb_friends" %></p>

      <div id="fb-root"></div>

      <script src="http://connect.facebook.net/en_US/all.js"></script>

      <script>
      $(function() {
        $("#invite_fb_friends").click(function() {
          console.log('clicked');
          FB.init({
            appId: '705147516194106',
            cookie: false,
            status: true,
          });
          FB.ui({method: 'apprequests', message:'<%= current_user.name %> would like to invite you to try Encore, and check out all of your favorite concert memories!'})
        });
      });

      </script>

    </div>
  <% end %>

  <div class="container">

    <div id='flash'>
      <% flash.each do |type, msg| %>
      <div class="alert alert-<%= type %>">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
        <%= msg %>
      </div>
      <% end %>
    </div>

    <%= yield %>

  </div>

</body>
</html>
